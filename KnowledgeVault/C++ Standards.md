[[C++]]

Существуют современные стандарты C++ добавляющие много новых возможностей. Однако существует ряд проблем и нюансов, связанных с использование современных стандартов.
- Проблемы/отсутствие поддержки со стороны части компиляторов / целевых платформ
- Проблемы/затраты при переходе на новый стандарт
- Не все фичи одинокого полезны. Некоторые имеют свои плюсы и минуты (например `auto`), другие же вовсе неприменимы в реальной разработке кроме исключительных случаев ([[Template Metaprogramming]])



**Игровой движок. Программирование и внутреннее устройство. Грегори Джейсон:**

Когда вы читаете о новых интересных функциях, добавляемых в C++, возникает соблазн задействовать все эти функции в своих движке или игре.

**Отсутствие полной поддержки.** Компилятор может не полностью поддерживать передовые функции. Например, LLVM/Clang, компилятор C++, используемый на Sony Playstation 4, в настоящее время поддерживает весь стандарт C++11 в версиях 3.3 и последующих и весь C++14 в версиях 3.4 и новее. Но его поддержка C++17 распространяется на версии Clang с 3.5 по 4.0, и в настоящее время он не поддерживает черновой вариант стандарта C++2a.

**Стоимость переключения между стандартами.** Существует ненулевая плата за переключение кодовой базы с одного стандарта на другой. Поэтому игровой студии важно выбрать для поддержки наиболее продвинутый стандарт C++ и придерживаться его в течение разумного периода (например, во время существования одного проекта). Мы в Naughty Dog приняли стандарт C++11 сравнительно недавно и разрешили его использовать только в той ветви кода, в которой разрабатывается The Last of Us Part II. Код в ветви, используемый для Uncharted 4: A Thief’s End и Uncharted: Lost Legacy, изначально был написан с помощью стандарта C++98, и мы решили, что довольно незначительные преимущества применения функций C++11 в этой кодовой базе не перевешивают стоимость и риски, связанные с переходом.

**Вознаграждение за риск.** Не все возможности языка C++ одинаковы. Некоторые функции полезны и в целом универсально приемлемы, например nullptr. Другие могут иметь как преимущества, так и недостатки. А некоторые языковые функции вообще можно счесть неприемлемыми для использования в коде движка в среде выполнения.

В качестве примера языковой функции, которая может считаться неподходящей для использования в коммерческом продукте, таком как игра, рассмотрим шаблонное метапрограммирование. Библиотека Loki Андрея Александреску активно задействует шаблонное метапрограммирование, чтобы выполнять довольно интересные и удивительные вещи. Однако полученный код труден для чтения, иногда непереносим, и его очень нелегко понять программистам. Ведущие специалисты Naughty Dog считают, что любой программист должен быть в состоянии быстро подключиться и отладить ошибку даже в коде, с которым он может быть плохо знаком.

Помните: когда у вас есть молоток, все может выглядеть как гвоздь. Не поддавайтесь искушению использовать возможности языка только потому, что они есть, или потому, что они новы. Благодаря разумному и тщательно продуманному подходу можно создать стабильную кодовую базу, которая будет настолько проста, насколько это возможно, для понимания, анализа, отладки и поддержки.
